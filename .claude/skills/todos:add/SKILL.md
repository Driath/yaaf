---
name: todos:add
description: Create a todo with a full implementation plan using the Plan agent
---

# todos:add

Creates a new todo in `todos/plans/` with a complete implementation plan generated by the Plan agent.

## Usage

```
/todos:add "Add user authentication"
/todos:add "Refactor the statusline component"
```

**Arguments:**
- `subject` (required): Brief description of the todo

## Instructions

### 1. Parse Input

Extract the subject from the argument. If no argument provided, use AskUserQuestion to request it.

### 2. Generate Slug

Convert subject to kebab-case slug:
- Lowercase
- Replace spaces with hyphens
- Remove special characters
- Max 50 chars

Example: "Add user authentication" → `add-user-authentication`

### 3. Check for Duplicates

Check if `todos/plans/{slug}.md` already exists. If yes, ask user:
- Overwrite existing?
- Use different name?
- Cancel?

### 4. Launch Plan Agent

Use the Task tool with `subagent_type: Plan` to generate an implementation plan:

```
Prompt: "Create an implementation plan for: {subject}

Explore the codebase to understand:
- What files need to be modified
- What dependencies exist
- What the acceptance criteria should be

Return a structured plan with:
1. Context (why this is needed)
2. Step-by-step implementation plan
3. Files to modify/create
4. Acceptance criteria
5. Risks or dependencies"
```

### 5. Create Todo File

Write to `todos/plans/{slug}.md`:

```markdown
---
name: {slug}
status: pending
created: {YYYY-MM-DD}
---

# {Subject}

## Context
{Context from Plan agent}

## Plan
{Step-by-step plan from Plan agent}

## Files to Modify
{List from Plan agent}

## Acceptance Criteria
{Criteria from Plan agent as checkboxes}

## Notes
{Risks/dependencies from Plan agent}
```

### 6. Confirm Creation

Output per `/skill:format:out`:

```
---
✅ todos:add completed

## Actions
- Created: todos/plans/{slug}.md
- Generated plan with {N} steps

## Result
Todo "{subject}" ready for implementation.
Run `/start` to begin work.
---
```

## Error Handling

- **No subject** → Ask via AskUserQuestion
- **Plan agent fails** → Create basic todo without detailed plan, note in output
- **File write fails** → Report error, suggest manual creation
